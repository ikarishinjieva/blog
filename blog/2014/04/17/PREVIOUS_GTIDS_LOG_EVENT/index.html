
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>PREVIOUS_GTIDS_LOG_EVENT的格式 - Tac say</title>
  <meta name="author" content="Tac Huang (ikari_shinji@github)">

  
  <meta name="description" content="并没找到特别好的对PREVIOUS_GTIDS_LOG_EVENT格式的描述, 自己写一个 据下面这个例子, 是mysqlbinlog的分析结果 # at 120
#140417 15:50:36 server id 904898000 end_log_pos 311 CRC32 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ikarishinjieva.github.com/blog/blog/2014/04/17/PREVIOUS_GTIDS_LOG_EVENT/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/blog/atom.xml" rel="alternate" title="Tac say" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>


<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Tac say</a></h1>
  
    <h2>只想做个程序演奏家</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">PREVIOUS_GTIDS_LOG_EVENT的格式</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-17T22:08:00+08:00" pubdate data-updated="true">Apr 17<span>th</span>, 2014</time>
        
		<script type="text/javascript" charset="utf-8">
		(function(){
		  var _w = 72 , _h = 16;
		  var param = {
			url:location.href.substring(0, location.href.length) + "",
			type:'3',
			count:'1', 
			appkey:'', 
			title:"", 
			pic:'', 
			ralateUid:'1460219211', 
			language:'zh_cn', 
			rnd:new Date().valueOf()
		  }
		  var temp = [];
		  for( var p in param ){
			temp.push(p + '=' + encodeURIComponent( param[p] || '' ) )
		  }
		  document.write('<iframe allowTransparency="true" frameborder="0" scrolling="no" src="http://hits.sinajs.cn/A1/weiboshare.html?' + temp.join('&') + '" width="'+ _w+'" height="'+_h+'" style="margin-left:10px;"></iframe>')
		})()
		</script>
      </p>
	  
    
  </header>


<div class="entry-content"><p>并没找到特别好的对<code>PREVIOUS_GTIDS_LOG_EVENT</code>格式的描述, 自己写一个</p>

<p>据下面这个例子, 是<code>mysqlbinlog</code>的分析结果</p>

<pre><code># at 120
#140417 15:50:36 server id 904898000  end_log_pos 311 CRC32 0x311ec069
# Position  Timestamp   Type   Master ID        Size      Master Pos    Flags
#       78 cc 87 4f 53   23   d0 a5 ef 35   bf 00 00 00   37 01 00 00   00 00
#       8b 04 00 00 00 00 00 00 00  7e 23 40 1a c6 03 11 e3 |................|
#       9b 8e 13 5e 10 e6 a0 5c fb  01 00 00 00 00 00 00 00 |................|
#       ab 01 00 00 00 00 00 00 00  06 00 00 00 00 00 00 00 |................|
#       bb 81 86 fc 1e c5 ff 11 e3  8d f9 e6 6c cf 50 db 66 |...........l.P.f|
#       cb 01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00 |................|
#       db 0c 00 00 00 00 00 00 00  a6 ce 32 8c c6 02 11 e3 |..........2.....|
#       eb 8e 0d e6 6c cf 50 db 66  01 00 00 00 00 00 00 00 |...l.P.f........|
#       fb 01 00 00 00 00 00 00 00  07 00 00 00 00 00 00 00 |................|
#      10b b7 00 99 20 c6 01 11 e3  8e 07 5e 10 e6 a0 5c fb |................|
#      11b 01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00 |................|
#      12b 07 00 00 00 00 00 00 00  69 c0 1e 31             |........i..1|
#      Previous-GTIDs
# 7e23401a-c603-11e3-8e13-5e10e6a05cfb:1-5,
# 8186fc1e-c5ff-11e3-8df9-e66ccf50db66:1-11,
# a6ce328c-c602-11e3-8e0d-e66ccf50db66:1-6,
# b7009920-c601-11e3-8e07-5e10e6a05cfb:1-6
</code></pre>

<p>从78-8a的位置, 是Binlog Event header, 参看<a href="http://dev.mysql.com/doc/internals/en/binlog-event-header.html">这里</a></p>

<p>最后四个字节, (69 c0 1e 31) 是checksum, 与参数 <a href="http://dev.mysql.com/doc/refman/5.6/en/replication-options-binary-log.html#option_mysqld_binlog-checksum">binlog-checksum</a> 有关</p>

<p>中间的部分, 是gtid的数据区, 格式如下:</p>

<table>
<thead>
<tr>
<th>层次 </th>
<th> 字节数 </th>
<th> 含义 </th>
<th> 例子中的数值</th>
</tr>
</thead>
<tbody>
<tr>
<td>0 </td>
<td> 8 </td>
<td> GTID中sid-number的组数 </td>
<td> 例子中为四组</td>
</tr>
<tr>
<td>1 </td>
<td> 16 </td>
<td> 第一组sid-number的sid部分 </td>
<td> 例子中为(7e 23 40 1a c6 03 11 e3 9b 8e 13 5e 10 e6 a0 5c fb)</td>
</tr>
<tr>
<td>1 </td>
<td> 8 </td>
<td> 第一组sid-number中, internal numbers的个数 </td>
<td> 例子中为1个internal number (<code>1-5</code>)</td>
</tr>
<tr>
<td>2 </td>
<td> 8 </td>
<td> 第一组sid-number中, 第一个internal number的起始number </td>
<td> 例子中为<code>1</code></td>
</tr>
<tr>
<td>2 </td>
<td> 8 </td>
<td> 第一组sid-number中, 第一个internal number的结束number+1 </td>
<td> 例子中为<code>5+1=6</code></td>
</tr>
<tr>
<td>2 </td>
<td> 8 </td>
<td> 第一组sid-number中, 第二个internal number的起始number </td>
<td> &#8230; (例子中没有第二个internal number)</td>
</tr>
<tr>
<td>2 </td>
<td> 8 </td>
<td> 第一组sid-number中, 第二个internal number的结束number+1 </td>
<td> &#8230; (例子中没有第二个internal number)</td>
</tr>
<tr>
<td>&#8230; </td>
<td> &#8230; </td>
<td> &#8230; </td>
<td> &#8230;</td>
</tr>
<tr>
<td>1 </td>
<td> 16 </td>
<td> 第二组sid-number的sid部分 </td>
<td> &#8230;</td>
</tr>
<tr>
<td>&#8230; </td>
<td> &#8230; </td>
<td> &#8230; </td>
<td> &#8230;</td>
</tr>
</tbody>
</table>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Tac Huang (ikari_shinji@github)</span></span>

      








  


<time datetime="2014-04-17T22:08:00+08:00" pubdate data-updated="true">Apr 17<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/blog/categories/gtid/'>GTID</a>, <a class='category' href='/blog/blog/categories/binlog/'>binlog</a>, <a class='category' href='/blog/blog/categories/mysql/'>mysql</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/blog/2014/04/05/MDL_map_partition-lock-split/" title="Previous Post: MDL_map_partition中对锁的过渡">&laquo; MDL_map_partition中对锁的过渡</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2014/04/17/PREVIOUS_GTIDS_LOG_EVENT/">PREVIOUS_GTIDS_LOG_EVENT的格式</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/04/05/MDL_map_partition-lock-split/">MDL_map_partition中对锁的过渡</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/04/04/MDL/">整理一下最近读的MDL源码</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/04/01/study-mysql-bug-70307-2/">对Mysql bug #70307 的再学习</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/03/26/mysql-fake-master-server/">mysql, 利用假master重放binlog</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/03/25/go-leak-fd/">golang, cmd会泄露文件句柄</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/03/20/go-file-lock/">golang, windows和linux上的文件锁</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/03/02/gen/">推荐下我修改的gen</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/02/22/go-exec-command-block-when-redirect-stdout/">GO exec.command.Wait 执行后台程序,在重定向输出时卡住</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/02/11/try-rollback-master-back-to-slave-by-mysql-plugin/">尝试使用mysql plugin将RESET SLAVE后的节点重新恢复成slave</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/01/28/compile-mysql-plugin/">编译mysql插件的碰到的问题</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/01/08/jruby-bug-tcp-timeout/">jruby中tcp阻塞时Timeout::timeout失效</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/12/26/go-iterate-variable/">栽在Go中for的变量</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/12/19/paxos-lease-2/">对于PaxosLease的个人理解 2</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/12/19/paxos-lease/">对于PaxosLease的个人理解 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/12/09/test-framework-exp/">关于DEV测试的一些经验总结</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/11/11/study-memory-reorder-cont/">对Memory Reordering Caught in the Act的学习 续 - 关于go的部分</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/11/07/study-memory-reorder/">对Memory Reordering Caught in the Act的学习</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/11/05/accrual-failure-detector/">对heartbeat φ累积失败检测算法的学习</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/10/25/study-mysql-bug-70307/">对Mysql bug #70307 的学习</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Weibo</h1>
  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=10&isTitle=1&noborder=0&isWeibo=1&isFans=0&uid=1460219211&verifier=4d7daebc&dpc=1"></iframe>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/ikarishinjieva">@ikarishinjieva</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'ikarishinjieva',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Tac Huang (ikari_shinji@github) -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a>.</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tacsay';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ikarishinjieva.github.com/blog/blog/2014/04/17/PREVIOUS_GTIDS_LOG_EVENT/';
        var disqus_url = 'http://ikarishinjieva.github.com/blog/blog/2014/04/17/PREVIOUS_GTIDS_LOG_EVENT/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa62a96d9f5c956ea3ddb6cca8ad83aa3' type='text/javascript'%3E%3C/script%3E"));
</script>










</body>
</html>
